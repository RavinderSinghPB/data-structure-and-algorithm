class Graph:
    def __init__(self):
        self.graph = dict()

    def add(self, u, v):
        if u in self.graph:
            self.graph[u].append(v)
        else:
            self.graph[u] = [v]


def dfs(g, k,clr, fvst, lvst,edg, dfsl):
    #global c, fvst, lvst, t, edg, dfsl
    dfsl.append(k)
    dfs.t += 1
    fvst[k] = dfs.t
    clr[k] = 'g'

    if k in g:
        for av in g[k]:
            if clr[av] == 'w':

                dfs(g, av,clr, fvst, lvst, edg, dfsl)
            elif clr[av] == 'g':
                edg['bck'].append((k, av))
            elif clr[av] == 'b':
                edg['crs'].append((k, av))


    clr[k] = 'b'
    dfs.t += 1
    lvst[k] = dfs.t



def Dfs(g):
    #global c, fvst, lvst, t
    clr = {}
    fvst = {}
    lvst = {}
    dfs.t = 0
    dfsl = []
    edg = {'bck': [], 'crs': []}

    for v, adjv in g.items():
        clr[v] = 'w'
        fvst[v] = 0
        lvst[v] = 0
        for av in adjv:
            clr[av] = 'w'
            fvst[av] = 0
            lvst[av] = 0
    for cn in g:
        if clr[cn] == 'w':
            dfs(g, cn,clr,fvst,lvst,edg,dfsl)

    # for k, v in edg.items():
    #     print(k, v)
    #
    # for v in dfsl:
    #     print('vrtx', v, 'first vst-->', fvst[v], 'last vst-->', lvst[v])

    if len(edg['bck'])>=1:
        return True
    else:
        return False





if __name__ == '__main__':
    T = int(input())

    for _ in range(T):
        g = Graph()

        V, E = [int(x) for x in input().split()]
        edgeInfo = [int(x) for x in input().split()]

        for i in range(0,2*E,2):
            u,v=edgeInfo[i],edgeInfo[i+1]
            g.add(u,v)

        if Dfs(g.graph):
            #back edge present
            print(1)
            print('~')
        else:
            print(0)
            print('~')


'''
i/p
24
28 66
3 0 16 11 21 20 23 23 26 1 14 23 21 25 15 9 10 12 19 3 4 1 20 20 11 23 13 2 14 16 4 2 0 4 13 5 25 20 0 7 6 15 14 27 24 1 20 6 25 23 22 14 25 26 18 20 5 15 7 20 4 23 22 16 27 19 22 8 12 6 15 18 21 1 1 2 14 21 8 24 16 14 10 25 12 12 2 2 0 9 22 16 16 0 4 15 19 10 24 15 17 23 5 22 25 18 24 23 11 5 19 12 3 13 21 16 26 23 18 10 16 24 26 4 24 2 4 27 25 12 15 14 
29 4
6 21 17 12 2 11 9 11 
15 77
1 10 12 0 3 4 5 0 11 0 8 8 2 13 12 6 0 10 13 5 5 10 12 8 3 2 3 10 12 12 12 6 14 1 6 9 5 3 9 8 3 10 8 12 0 6 4 7 1 2 12 14 12 1 7 7 11 10 3 8 14 0 6 5 1 13 14 13 8 8 13 12 10 7 9 10 5 5 2 13 7 7 12 11 8 4 4 4 6 14 5 12 14 11 2 7 1 1 12 10 2 2 14 12 9 8 0 6 6 9 5 13 1 2 2 2 14 13 6 5 12 11 10 11 0 12 10 1 14 7 11 8 1 2 5 11 3 12 9 9 7 14 14 0 9 1 2 8 14 1 5 11 4 0 
14 32
2 9 0 9 12 9 6 1 9 12 13 10 2 12 0 11 0 8 7 8 12 5 9 9 5 1 3 2 0 3 10 2 12 8 9 8 3 13 9 10 10 6 6 12 3 6 7 3 13 0 11 11 5 4 4 10 4 7 13 4 8 7 4 4 
17 90
15 12 0 6 13 14 5 1 13 4 16 15 7 7 14 12 5 14 14 8 14 9 1 2 8 0 0 5 7 0 4 5 3 4 2 7 9 7 8 13 2 8 11 10 6 16 5 11 13 2 3 1 11 12 4 10 12 12 6 2 13 10 15 7 14 0 6 14 15 14 11 1 13 5 2 2 5 7 5 9 0 16 11 11 11 6 13 6 1 10 16 5 4 14 13 9 5 10 7 3 7 1 12 12 14 14 5 2 12 10 3 12 9 14 15 3 11 2 0 3 12 16 9 16 13 13 0 9 6 7 4 4 16 16 7 13 5 13 7 8 14 10 4 7 15 10 1 9 12 10 12 15 9 12 15 14 8 6 6 5 13 10 1 12 1 8 8 14 4 15 5 2 16 9 0 14 10 9 14 13 
18 70
3 2 16 17 1 10 12 16 0 5 0 14 3 8 2 13 1 10 13 12 1 8 3 8 17 8 14 5 2 4 1 3 4 15 1 3 7 13 1 5 0 1 17 2 7 1 15 8 11 8 0 10 16 2 16 13 8 10 1 11 12 0 12 16 15 13 1 2 8 0 7 7 17 6 7 5 5 2 11 14 11 10 4 7 12 0 1 2 10 0 11 5 16 6 1 13 1 1 13 8 1 2 15 17 6 4 4 9 4 15 5 15 5 7 3 17 7 2 0 15 0 9 2 16 15 2 11 15 3 6 5 2 6 0 1 10 2 3 1 6 
24 39
14 22 17 5 10 10 23 14 19 11 17 8 21 1 16 6 10 1 16 21 15 20 15 15 12 11 18 1 17 17 3 23 16 12 20 18 22 19 8 9 22 17 17 19 18 1 17 4 2 9 17 10 5 0 1 9 3 11 2 21 5 5 12 13 9 9 7 7 4 7 9 3 0 18 14 11 20 8 
20 20
18 16 3 18 18 6 16 18 18 2 1 1 8 13 18 6 10 8 0 17 13 16 5 5 16 9 13 5 10 4 4 9 13 7 7 11 5 16 9 3 
19 26
4 5 18 4 5 4 6 7 12 8 5 6 1 14 1 16 7 4 6 14 16 12 6 1 7 8 2 7 12 18 7 16 2 3 17 7 7 4 11 16 13 13 4 11 5 5 8 13 6 11 5 1 
11 16
7 8 9 0 6 3 9 7 7 2 2 5 4 7 3 2 6 7 7 0 2 7 3 6 7 4 9 4 4 0 8 9 
28 5
3 17 6 13 7 8 27 18 23 11 
27 5
12 20 0 12 3 12 20 9 15 22 
15 46
3 6 1 7 8 6 6 13 0 13 14 7 6 7 8 4 2 14 2 7 11 13 7 11 9 13 7 7 12 3 4 7 9 5 6 9 3 12 7 3 2 6 11 8 14 11 4 1 2 7 0 13 12 8 2 13 13 9 5 10 5 2 9 14 14 0 1 3 4 8 13 6 0 1 7 6 12 3 14 6 10 0 5 0 0 7 13 13 8 11 1 13 
24 68
20 7 21 6 10 19 8 3 18 3 8 7 16 15 11 13 12 11 8 0 14 8 22 13 4 14 4 15 12 15 3 8 23 16 6 9 3 15 4 21 10 13 20 3 20 8 8 0 19 16 1 1 16 15 14 12 21 19 4 10 10 23 10 9 15 17 11 10 0 7 0 2 12 20 21 8 20 5 1 7 21 2 0 13 9 7 18 7 18 14 9 20 13 11 6 20 20 9 6 12 8 6 15 21 19 12 5 7 18 22 7 7 16 7 13 2 6 7 1 0 21 10 21 10 13 19 22 10 4 20 22 12 3 13 9 14 
25 43
8 9 5 9 9 12 18 24 7 22 5 23 9 0 2 21 5 6 24 20 23 16 18 22 22 10 7 24 8 6 18 16 17 24 2 1 13 22 2 20 19 10 20 3 10 0 2 15 6 3 12 4 19 5 2 18 18 11 19 3 19 13 21 14 14 23 17 4 20 20 1 16 5 23 21 17 23 23 9 4 1 21 11 22 3 15 
26 47
8 0 4 14 21 21 3 1 0 23 11 25 23 11 2 24 6 22 22 7 25 15 13 25 15 6 10 17 5 0 7 13 0 12 1 24 9 7 25 11 4 11 10 1 22 14 1 5 10 23 12 10 12 2 9 1 8 22 20 15 22 2 2 22 16 6 20 25 13 22 12 17 7 24 20 5 12 21 10 24 18 25 8 6 1 20 7 11 18 3 1 14 5 3 
26 65
17 1 18 0 1 18 25 16 5 7 25 7 23 0 17 18 15 25 16 8 17 2 19 15 8 5 0 9 1 15 1 20 18 21 20 19 15 22 12 20 3 13 1 2 13 20 22 4 20 15 14 13 17 7 2 25 12 2 10 13 19 12 9 12 9 4 7 25 0 19 19 5 8 23 9 21 17 6 1 13 21 16 0 12 23 2 14 12 6 24 1 2 12 11 14 22 15 21 21 17 17 16 24 25 13 7 23 5 13 24 18 10 14 19 25 14 23 13 0 6 13 1 8 2 14 24 0 5 21 21 
11 9
2 3 9 5 1 9 10 6 7 5 0 1 5 9 2 2 7 3 
14 48
2 7 4 2 0 1 1 5 7 5 6 8 0 7 9 2 5 5 2 4 0 13 6 5 2 8 6 9 1 13 6 3 7 10 5 7 11 6 12 3 9 2 9 7 9 4 10 12 8 12 2 6 10 9 12 12 1 2 5 2 1 12 3 8 6 8 1 2 12 12 3 7 0 10 1 10 13 9 8 7 7 9 13 1 2 11 12 1 13 3 1 13 13 4 7 6 
11 76
7 9 5 6 0 0 2 5 2 3 3 1 4 9 7 10 5 8 10 3 6 3 8 3 3 0 8 5 9 10 5 5 8 8 9 6 9 10 10 9 2 2 10 7 9 4 4 2 10 3 3 5 6 0 8 7 1 3 2 10 2 5 3 8 1 1 4 10 9 3 6 1 3 6 6 0 8 10 2 8 0 3 2 7 4 9 1 5 1 3 2 2 9 5 8 10 5 10 7 3 2 2 2 4 6 6 2 4 5 2 10 4 5 1 9 9 10 10 1 1 3 2 1 10 5 9 7 10 9 1 1 9 1 1 0 8 8 2 10 0 4 9 2 8 8 0 4 8 0 6 7 3 
17 77
1 13 6 13 15 1 0 14 5 13 12 3 10 0 5 13 8 16 0 3 1 10 9 8 15 7 9 16 1 7 7 10 11 13 14 9 6 14 14 11 10 1 14 4 1 10 8 9 1 0 4 2 10 13 1 16 11 10 15 12 0 5 5 12 9 10 12 15 7 1 0 0 2 6 12 11 16 12 4 8 12 8 2 5 12 3 4 6 14 10 9 5 6 5 0 15 15 4 5 5 5 5 13 7 11 9 9 2 4 4 1 7 3 3 12 15 7 7 4 12 0 13 0 6 1 1 12 7 13 0 12 1 14 9 16 8 9 8 1 4 13 3 11 16 6 6 6 4 13 1 16 4 15 0 
21 52
17 1 10 9 17 3 12 5 18 17 2 12 6 19 3 19 9 13 5 20 4 20 18 9 3 10 5 6 2 3 3 19 2 13 5 19 14 17 1 10 11 1 1 18 18 2 16 6 15 19 6 18 18 1 4 19 11 8 2 14 9 6 10 11 19 16 9 11 10 8 0 1 7 1 19 5 1 12 11 14 10 17 9 5 19 14 1 9 1 4 0 8 10 9 19 6 4 5 17 12 13 15 13 20 
11 22
8 10 4 6 10 5 0 9 0 8 1 7 0 6 9 5 8 10 4 4 10 2 2 1 10 10 7 4 10 6 1 8 3 3 1 1 8 0 10 6 8 0 2 6 
22 77
0 12 18 5 4 17 5 6 5 3 14 10 7 14 3 8 20 6 9 10 18 6 8 18 13 14 16 13 20 8 10 21 20 6 2 0 21 5 4 4 8 19 12 13 11 15 19 9 21 6 17 18 13 2 12 2 16 4 13 15 12 21 14 9 5 14 9 2 19 14 6 4 11 16 17 20 9 15 5 9 19 20 3 10 0 15 10 17 19 0 10 8 21 0 17 5 12 4 5 7 16 12 11 3 4 5 1 14 18 4 1 15 3 4 2 1 17 10 18 12 10 4 20 10 2 15 13 14 18 18 0 12 6 9 16 11 14 15 3 10 20 2 2 21 4 4 0 19 14 17 9 3 21 6 

o/p
1
~
0
~
1
~
1
~
1
~
1
~
1
~
1
~
1
~
1
~
0
~
0
~
1
~
1
~
1
~
1
~
1
~
1
~
1
~
1
~
1
~
1
~
1
~
1
~
'''
